#ifndef GRAMMARYZER_H
#define GRAMMARYZER_H
#include <map>
#include <vector>
#include <stack>

#include "Tokenizer.h"
#include "Token.h"

#include <algorithm>
#include <iostream>

class Grammaryzer {
public:
    Grammaryzer();
    ~Grammaryzer();

    std::string checkGrammar() const;
    Tokenizer* tokenizer;

    static std::map<int, std::vector<int>> expectedTokens;

private:
    const std::map<int, int> stateToRow = {
        {1000, 0},
        {1001, 1},
        {1002, 2},
        {1003, 3},
        {1004, 4},
        {1005, 5},
        {1006, 6},
        {1007, 7},
        {1008, 8},
        {1009, 9},
        {1010, 10},
        {1011, 11},
        {1012, 12},
        {1013, 13},
        {1014, 14},
        {1015, 15},
        {1016, 16},
        {1017, 17},
        {1018, 18},
        {1019, 19},
        {1020, 20},
        {1021, 21},
        {1022, 22},
        {1023, 23},
        {1024, 24},
        {1025, 25},
        {1026, 26},
        {1027, 27},
        {1028, 28},
        {1029, 29},
        {1030, 30},
        {101, 31},
        {102, 32},
        {103, 33},
        {104, 34},
        {105, 35},
        {106, 36},
        {107, 37},
        {108, 38},
        {109, 39},
        {110, 40},
        {111, 41},
        {112, 42},
        {113, 43},
        {114, 44},
        {115, 45},
        {116, 46},
        {117, 47},
        {118, 48},
        {119, 49},
        {120, 50},
        {123, 51},
        {124, 52},
        {125, 53},
        {126, 54},
        {128, 55},
        {129, 56},
        {130, 57},
        {133, 58},
        {134, 59},
        {499, 60}
    };

    int matrizPredictiva[43][61] = {
        {
            1, 600, 600, 1, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 1, 1,
            600, 600, 600, 600, 1, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600,
            600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600, 600
        },
        {
            601, 601, 601, 5, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 2, 3,
            601, 601, 601, 601, 4, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601,
            601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601, 601
        },
        {
            6, 602, 602, 7, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 7, 7,
            602, 602, 602, 602, 7, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602,
            602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602, 602
        },
        {
            603, 603, 603, 9, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 9,
            8, 603, 603, 603, 603, 9, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603,
            603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603, 603
        },
        {
            604, 604, 604, 11, 11, 604, 604, 604, 604, 604, 604, 11, 11, 11, 11, 11, 604, 11, 11, 11, 11, 10, 11, 604,
            11, 11, 11, 11, 11, 11, 604, 11, 604, 604, 604, 604, 604, 604, 604, 604, 604, 604, 604, 604, 604, 604, 604,
            604, 604, 604, 604, 604, 604, 604, 604, 604, 11, 11, 604, 604, 604
        },
        {
            605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605,
            605, 605, 13, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 605, 13, 605, 605, 605,
            605, 605, 605, 605, 605, 605, 605, 13, 605, 12, 605, 605, 605, 605, 605, 605, 605, 605
        },
        {
            606, 606, 606, 14, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606,
            606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606,
            606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606, 606
        },
        {
            607, 607, 607, 607, 607, 15, 16, 17, 18, 19, 20, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607,
            607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607,
            607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607, 607
        },
        {
            608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608,
            608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 21, 22, 23, 608, 608, 608, 608, 608, 608, 608, 608,
            608, 608, 608, 608, 608, 608, 608, 608, 608, 608, 24, 25, 608, 608, 608, 608, 608, 608
        },
        {
            609, 609, 609, 27, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 27,
            27, 609, 609, 609, 609, 26, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609,
            609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609, 609
        },
        {
            610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610,
            610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 28, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610,
            610, 610, 610, 610, 610, 610, 610, 29, 610, 610, 610, 610, 610, 610, 610, 610, 610, 610
        },
        {
            611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611,
            611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 30, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611, 611,
            611, 611, 611, 611, 611, 611, 611, 31, 611, 30, 611, 611, 611, 611, 611, 611, 611, 611
        },
        {
            612, 612, 612, 612, 41, 612, 612, 612, 612, 612, 612, 37, 41, 41, 41, 39, 612, 38, 41, 35, 34, 612, 612,
            612, 41, 40, 41, 612, 41, 33, 612, 32, 612, 612, 612, 612, 612, 612, 612, 612, 612, 612, 612, 612, 612, 612,
            612, 612, 612, 612, 612, 612, 612, 612, 612, 612, 36, 36, 612, 612, 612
        },
        {
            613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613,
            613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 42, 613, 613, 613,
            613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 613, 43, 43, 613, 613, 613
        },
        {
            614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614,
            614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 44, 614, 614, 614,
            614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614, 614
        },
        {
            615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 45, 615,
            615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615,
            615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615, 615
        },
        {
            616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 616,
            616, 616, 616, 616, 616, 616, 616, 616, 616, 616, 46, 46, 46, 46, 616, 616, 616, 616, 616, 616, 616, 616,
            616, 616, 616, 46, 616, 616, 46, 616, 616, 616, 46, 46, 616, 616, 616, 616, 616, 616
        },
        {
            617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617,
            617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617, 617,
            617, 617, 617, 617, 617, 617, 617, 617, 48, 617, 47, 617, 617, 617, 617, 617, 617, 617, 617
        },
        {
            618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 49, 618, 618,
            618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618,
            618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618, 618
        },
        {
            619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619,
            619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619,
            619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 619, 50, 51, 619, 619, 619
        },
        {
            620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620,
            620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620,
            620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 620, 52, 53, 620, 620, 620
        },
        {
            621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 54, 621, 621, 621, 621, 621, 621,
            621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621,
            621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621, 621
        },
        {
            622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 55, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622,
            622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622,
            622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622, 622
        },
        {
            623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 56, 57, 57, 623, 623, 623, 623, 623, 623, 623,
            623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623,
            623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623, 623
        },
        {
            624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 58, 59, 624, 624, 624, 624, 624, 624, 624,
            624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624,
            624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624, 624
        },
        {
            625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 60, 625, 625, 625, 625,
            625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625,
            625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625, 625
        },
        {
            626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626,
            626, 626, 626, 626, 61, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626,
            626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626, 626
        },
        {
            627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627,
            627, 627, 627, 627, 627, 627, 627, 627, 62, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627,
            627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627, 627
        },
        {
            628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 628,
            628, 628, 628, 628, 628, 628, 628, 628, 628, 628, 63, 63, 63, 63, 628, 628, 628, 628, 628, 628, 628, 628,
            628, 628, 628, 63, 628, 628, 63, 628, 628, 628, 63, 63, 628, 628, 628, 628, 628, 628
        },
        {
            629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629,
            629, 629, 629, 629, 629, 629, 629, 629, 629, 65, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629, 629,
            629, 629, 629, 629, 629, 64, 629, 65, 65, 65, 629, 629, 629, 629, 629, 629, 629, 629
        },
        {
            630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 630,
            630, 630, 630, 630, 630, 630, 630, 630, 630, 630, 66, 66, 66, 66, 630, 630, 630, 630, 630, 630, 630, 630,
            630, 630, 630, 66, 630, 630, 66, 630, 630, 630, 66, 66, 630, 630, 630, 630, 630, 630
        },
        {
            631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631,
            631, 631, 631, 631, 631, 631, 631, 631, 631, 68, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631, 631,
            631, 631, 631, 631, 67, 68, 631, 68, 68, 68, 631, 631, 631, 631, 631, 631, 631, 631
        },
        {
            632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 632,
            632, 632, 632, 632, 632, 632, 632, 632, 632, 632, 69, 69, 69, 69, 632, 632, 632, 632, 632, 632, 632, 632,
            632, 632, 632, 70, 632, 632, 69, 632, 632, 632, 69, 69, 632, 632, 632, 632, 632, 632
        },
        {
            633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 633,
            633, 633, 633, 633, 633, 633, 633, 633, 633, 633, 71, 71, 71, 71, 633, 633, 633, 633, 633, 633, 633, 633,
            633, 633, 633, 633, 633, 633, 71, 633, 633, 633, 71, 71, 633, 633, 633, 633, 633, 633
        },
        {
            634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634, 634,
            634, 634, 634, 634, 634, 634, 634, 634, 634, 73, 634, 634, 634, 634, 634, 634, 634, 634, 634, 72, 72, 72,
            72, 72, 72, 634, 73, 73, 634, 73, 73, 73, 634, 634, 634, 634, 634, 634, 634, 634
        },
        {
            635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635,
            635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 74, 76, 77,
            78, 79, 75, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635, 635
        },
        {
            636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 636,
            636, 636, 636, 636, 636, 636, 636, 636, 636, 636, 80, 80, 80, 80, 636, 636, 636, 636, 636, 636, 636, 636,
            636, 636, 636, 636, 636, 636, 80, 636, 636, 636, 80, 80, 636, 636, 636, 636, 636, 636
        },
        {
            637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637, 637,
            637, 637, 637, 637, 637, 637, 637, 637, 637, 83, 637, 637, 637, 637, 81, 82, 637, 637, 637, 83, 83, 83, 83,
            83, 83, 637, 83, 83, 637, 83, 83, 83, 637, 637, 637, 637, 637, 637, 637, 637
        },
        {
            638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 638,
            638, 638, 638, 638, 638, 638, 638, 638, 638, 638, 84, 84, 84, 84, 638, 638, 638, 638, 638, 638, 638, 638,
            638, 638, 638, 638, 638, 638, 84, 638, 638, 638, 84, 84, 638, 638, 638, 638, 638, 638
        },
        {
            639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639, 639,
            639, 639, 639, 639, 639, 639, 639, 639, 639, 89, 639, 639, 639, 639, 89, 89, 85, 86, 639, 89, 89, 89, 89,
            89, 89, 639, 89, 89, 639, 89, 89, 89, 639, 639, 87, 639, 639, 88, 639, 639
        },
        {
            640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 640,
            640, 640, 640, 640, 640, 640, 640, 640, 640, 640, 90, 91, 91, 91, 640, 640, 640, 640, 640, 640, 640, 640,
            640, 640, 640, 640, 640, 640, 92, 640, 640, 640, 91, 91, 640, 640, 640, 640, 640, 640
        },
        {
            641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641, 641,
            641, 641, 641, 641, 641, 641, 641, 641, 641, 94, 641, 641, 641, 641, 94, 94, 94, 94, 641, 94, 94, 94, 94,
            94, 94, 641, 94, 94, 93, 94, 94, 94, 641, 641, 94, 641, 641, 94, 641, 641
        },
        {
            642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642,
            642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 95, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642,
            642, 642, 642, 642, 642, 642, 642, 96, 642, 642, 642, 642, 642, 642, 642, 642, 642, 642
        },
    };

    std::vector<std::vector<int>> matrizProducciones = {
        {3, 7, 2, 3},
        {2, 2, 5},
        {2, 2, 4},
        {2, 2, 10},
        {0, -100},
        {6, 3, 123, 1001, 134, 101, 1000},
        {0, -100},
        {6, 4, 123, 9, 109, 101, 1022},
        {0, -100},
        {7, 5, 123, 8, 1023, 6, 101, 1021},
        {0, -100},
        {3, 6, 101, 124},
        {0, -100},
        {3, 1004, 13, 1003},
        {1, 1005},
        {1, 1006},
        {1, 1007},
        {1, 1008},
        {1, 1009},
        {1, 1010},
        {1, 102},
        {1, 103},
        {1, 104},
        {1, 125},
        {1, 126},
        {11, 10, 1028, 13, 5, 120, 11, 119, 8, 109, 101, 1027},
        {0, -100},
        {5, 12, 8, 109, 6, 101},
        {0, -100},
        {2, 11, 124},
        {0, -100},
        {2, 14, 101},
        {3, 13, 123, 28},
        {3, 13, 123, 16},
        {3, 13, 123, 19},
        {3, 13, 123, 20},
        {2, 13, 23},
        {2, 13, 26},
        {2, 13, 22},
        {2, 13, 27},
        {0, -100},
        {3, 13, 123, 15},
        {3, 13, 123, 21},
        {2, 29, 109},
        {4, 120, 17, 119, 1020},
        {2, 18, 29},
        {2, 17, 124},
        {0, -100},
        {5, 120, 6, 101, 119, 1019},
        {2, 101, 129},
        {2, 101, 130},
        {1, 129},
        {1, 130},
        {7, 1016, 120, 29, 119, 1024, 13, 1015},
        {8, 1014, 25, 24, 13, 120, 29, 119, 1011},
        {6, 24, 13, 120, 29, 119, 1012},
        {0, -100},
        {2, 13, 1013},
        {0, -100},
        {6, 1018, 13, 120, 29, 119, 1017},
        {9, 1026, 13, 120, 29, 1030, 29, 119, 101, 1025},
        {2, 29, 1029},
        {2, 30, 31},
        {2, 29, 118},
        {0, -100},
        {2, 32, 33},
        {2, 31, 117},
        {0, -100},
        {1, 34},
        {2, 34, 116},
        {2, 35, 37},
        {2, 37, 36},
        {0, -100},
        {1, 110},
        {1, 115},
        {1, 111},
        {1, 112},
        {1, 113},
        {1, 114},
        {2, 38, 39},
        {2, 37, 105},
        {2, 37, 106},
        {0, -100},
        {2, 40, 41},
        {2, 39, 107},
        {2, 39, 108},
        {2, 39, 128},
        {2, 39, 133},
        {0, -100},
        {2, 42, 101},
        {1, 9},
        {3, 120, 29, 119},
        {3, 120, 43, 119},
        {0, -100},
        {2, 6, 101},
        {0, -100},
    };
};


#endif //GRAMMARYZER_H
